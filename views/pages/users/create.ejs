<%- include('../../partials/head'); %>

<body>
<div id="usersResist" class="container">
  <h4 class="mb-4 fw-bold">
    新規登録画面
  </h4>

  <div v-if="errors.length" class="alert alert-danger">
    <template v-for="item in errors" :key="item">
      ■{{ item.property }}エラー
      <p v-for="i in item.constraints" :key="item">{{ i }}</p>
    </template>
  </div>

  <form @submit.prevent="onSubmit" name="users">
    <input v-model="userName" type="text" name="userName">
    <div v-if="$v.userName.$dirty" class="text-danger fw-bold">
      <span v-if="!$v.userName.required">userNameが入力されていません。</span>
    </div> 
    <div class="text-end">
      <button type="submit" class="btn baseBtnBlue" style="width: 156px;">登録</button>
    </div>
  </form>
</div>

<script type="text/javascript">
const errors = `<%- errors %>`;

Vue.use(window.vuelidate.default);
const { required } = window.validators;

new Vue({
  el: "#usersResist",
  data: {
    errors: JSON.parse(errors),
    // 登録データ
    userName: ''
  },
  mounted() {
  },
  validations: {
    userName: {
      required
    }
  },
  methods: {
    /**
     * 登録処理
     */ 
    onSubmit() {
      this.$v.$touch();
      if(!this.$v.$invalid) {
        document.users.method = 'post';
        document.users.action = '/users/create';
        document.users.submit();
      }
    }
  }
})
</script>
</body>
</html>
